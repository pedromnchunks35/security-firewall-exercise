# Generated by iptables-save v1.4.7 on Tue May 30 18:26:01 2023
# RULE A
*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT DROP [0:0]
# RULE B
-A INPUT -m state  --state RELATED,ESTABLISHED -j ACCEPT
-A OUTPUT -m state --state RELATED,ESTABLISHED -j ACCEPT
# RULE C
-A INPUT -i lo -j ACCEPT
-A OUTPUT -o lo -j ACCEPT
# RULE D (This is for ip address discovery), we allow udp in the source ports 67 to 68
-A OUTPUT -p udp --dport 67:68 --sport 67:68 -j ACCEPT
# RULE E (For dns, to find domain namespaces we need to allow destination port 53 both for udp and tcp) 
-A OUTPUT -p udp -m udp --dport 53 -j ACCEPT
-A OUTPUT -p tcp --dport 53 -j ACCEPT
# RULE F
# SSH
-A INPUT -p tcp -i eth0 -m state --state NEW -m tcp --dport 22 -j ACCEPT
# HTTP
-A INPUT -p tcp -i eth0 -m state --state NEW -m tcp --dport 80 -j ACCEPT
-A INPUT -p tcp -i eth0 -m state --state NEW -m tcp --dport 443 -j ACCEPT
# SMTP
-A OUTPUT -p tcp --dport 25 -j ACCEPT
# NTP
-A OUTPUT -p udp --dport 123 -j ACCEPT
# ICMP
-A OUTPUT -p icmp -j ACCEPT
COMMIT
# Completed on Tue May 30 18:26:01 2023
